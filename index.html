<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Подарки Mini App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <div id="content">
      <section id="cases" class="section active">
        <h2>Кейсы</h2>
        <p>Тут будут кейсы</p>
      </section>
      <section id="earn" class="section">
        <h2>Заработать</h2>
        <p>тут будут задания.</p>
      </section>
      <section id="invite" class="section">
        <h2>Приглашения</h2>
        <p>Тут будут инвайты.</p>
      </section>
      <section id="shop" class="section">
        <h2>Магазин подарков</h2>
        <p>Здесь будет магазин подарков</p>
      </section>
      <section id="profile" class="section">
        <h2>Профиль</h2>

        <div class="profile-card" id="profileCard">
          <img id="userAvatar" class="avatar" src="" alt="avatar" />
          <div class="profile-info">
            <div id="userFullName" class="fullname">Имя</div>
            <div id="userUsername" class="username">@username</div>
          </div>
        </div>

        <label class="effects-toggle">
          <input type="checkbox" id="effectsToggle" checked />
          Анимации
        </label>
      </section>
    </div>
  </div>

  <div class="bottom-nav">
    <button onclick="navigate('cases')" class="nav-button" aria-label="Кейсы"><img src="Icon/case1.png" alt=""></button>
    <button onclick="navigate('earn')" class="nav-button" aria-label="Заработать"><img src="Icon/Quest.png" alt=""></button>
    <button onclick="navigate('invite')" class="nav-button" aria-label="Приглашения"><img src="Icon/friend1.png" alt=""></button>
    <button onclick="navigate('shop')" class="nav-button" aria-label="Магазин подарков"><img src="Icon/Store.png" alt=""></button>
    <button onclick="navigate('profile')" class="nav-button" aria-label="Профиль"><img src="Icon/Profile2.png" alt=""></button>
  </div>

  <script>
    // Telegram WebApp API
    const tg = window.Telegram.WebApp;
    const user = tg.initDataUnsafe?.user;

    if (user) {
      document.getElementById('userFullName').textContent = `${user.first_name || ''} ${user.last_name || ''}`.trim();
      document.getElementById('userUsername').textContent = user.username ? `@${user.username}` : '';
      if (user.photo_url) {
        document.getElementById('userAvatar').src = user.photo_url;
      } else {
        document.getElementById('userAvatar').src = 'https://via.placeholder.com/64'; // запасной аватар
      }
    } else {
      document.getElementById('userFullName').textContent = 'Гость';
      document.getElementById('userUsername').textContent = '';
      document.getElementById('userAvatar').src = 'https://via.placeholder.com/64';
    }

    // Эффекты
    let effectsEnabled = localStorage.getItem('effectsEnabled');
    if (effectsEnabled === null) effectsEnabled = 'true';
    else effectsEnabled = effectsEnabled === 'true';

    const effectsToggle = document.getElementById('effectsToggle');
    effectsToggle.checked = effectsEnabled;

    function setEffectsState(enabled) {
      effectsEnabled = enabled;
      localStorage.setItem('effectsEnabled', enabled);
      document.body.classList.toggle('effects-disabled', !enabled);
    }

    effectsToggle.addEventListener('change', () => {
      setEffectsState(effectsToggle.checked);
    });

    setEffectsState(effectsEnabled);

    // Навигация
    function navigate(sectionId) {
      const sections = document.querySelectorAll('.section');
      const current = document.querySelector('.section.active');
      if (current.id === sectionId) return;

      if (effectsEnabled) {
        current.classList.add('fade-out');
        current.classList.remove('fade-in');

        setTimeout(() => {
          current.classList.remove('active', 'fade-out');
          const next = document.getElementById(sectionId);
          next.classList.add('active', 'fade-in');
        }, 300);
      } else {
        current.classList.remove('active', 'fade-in', 'fade-out');
        document.getElementById(sectionId).classList.add('active');
      }
    }
  </script>
</body>
</html>
